{"version":3,"file":"js/490.b881a9cc.js","mappings":"wJAKA,MAAMA,EAAMC,IAAAA,SAEZD,EAAIE,aAAaC,QAAQC,KAAIC,IACxBC,aAAaC,QAAQ,kBACtBF,EAAOG,QAAQC,cAAiB,OAAMH,aAAaC,QAAQ,mBAEtDF,KACNK,QAGHV,EAAIE,aAAaS,SAASP,KAAIC,IACzBC,aAAaC,QAAQ,kBACtBF,EAAOG,QAAQC,cAAiB,OAAMH,aAAaC,QAAQ,mBAEtDF,KACNK,IACC,GAAkC,oBAA7BA,EAAMC,SAASC,KAAKC,KACrB,OAAOZ,IAAAA,KAAY,GAAEa,EAAAA,EAAAA,QAAAA,gCAA+C,CAChE,QAAWR,aAAaC,QAAQ,mBACjCQ,MAAKC,IAEJV,aAAaW,QAAQ,eAAgBD,EAAIJ,KAAKM,QAE9CR,EAAML,OAAOI,cAAiB,OAAMH,aAAaC,QAAQ,kBAElDP,EAAIG,QAAQO,EAAML,WAC1BK,OAAMS,IACLC,QAAQC,IAAI,yBACZP,EAAAA,EAAAA,OAAa,SAAS,GAE9B,IAMJ,Q,uJClCUQ,EAAAA,EAAAA,GAA8C,QAAxCC,MAAA,wBAA0B,WAAO,G,GACpCA,MAAA,4B,GAKHD,EAAAA,EAAAA,GAAkD,QAA5CC,MAAA,wBAA0B,eAAW,G,GACxCA,MAAA,4B,GAKHD,EAAAA,EAAAA,GAA4C,QAAtCC,MAAA,wBAA0B,SAAK,G,GAClCA,MAAA,4B,4EAnBXC,EAAAA,EAAAA,IAmEM,aAhEJC,EAAAA,EAAAA,IAmBSC,EAAAA,EAAAA,CAnBDC,MAAM,aAAW,C,kBACvB,IAKgB,EALhBF,EAAAA,EAAAA,IAKgBG,EAAAA,KAAAA,C,kBAJd,IAGM,EAHNN,EAAAA,EAAAA,GAGM,YAFJO,GACAP,EAAAA,EAAAA,GAAoD,IAApDQ,GAAoD,QAAhBC,EAAAA,KAAKC,OAAK,Q,OAGlDP,EAAAA,EAAAA,IAKgBG,EAAAA,KAAAA,C,kBAJd,IAGM,EAHNN,EAAAA,EAAAA,GAGM,YAFJW,GACAX,EAAAA,EAAAA,GAAwD,IAAxDY,GAAwD,QAApBH,EAAAA,KAAKI,WAAS,Q,OAGtDV,EAAAA,EAAAA,IAKgBG,EAAAA,KAAAA,C,kBAJd,IAGM,EAHNN,EAAAA,EAAAA,GAGM,YAFJc,GACAd,EAAAA,EAAAA,GAAmD,IAAnDe,GAAmD,QAAfN,EAAAA,KAAKO,MAAI,Q,gBAKnDb,EAAAA,EAAAA,IAyCcc,EAAAA,EAAAA,KAAAA,C,kBAxCZ,IAuCS,EAvCTd,EAAAA,EAAAA,IAuCSe,EAAAA,EAAAA,CAvCDC,IAAI,QAAM,C,kBAChB,IAOa,EAPbhB,EAAAA,EAAAA,IAOaiB,EAAAA,EAAAA,C,WANAX,EAAAA,KAAKC,M,qCAALD,EAAAA,KAAKC,MAAK,GACnBW,MAAM,SACNC,KAAK,OACLC,QAAQ,WACPC,MAAK,CAAKf,EAAAA,MAAMgB,W,gCAIrBtB,EAAAA,EAAAA,IAOaiB,EAAAA,EAAAA,C,WANAX,EAAAA,KAAKI,U,qCAALJ,EAAAA,KAAKI,UAAS,GACvBQ,MAAM,aACNC,KAAK,OACLC,QAAQ,WACPC,MAAK,CAAKf,EAAAA,MAAMgB,W,gCAIrBtB,EAAAA,EAAAA,IAOaiB,EAAAA,EAAAA,C,WANAX,EAAAA,KAAKO,K,qCAALP,EAAAA,KAAKO,KAAI,GAClBK,MAAM,OACNC,KAAK,OACLC,QAAQ,WACPC,MAAK,CAAKf,EAAAA,MAAMgB,W,gCAIrBtB,EAAAA,EAAAA,IAScc,EAAAA,EAAAA,CARVS,MAAM,UAAQ,C,kBAChB,IAMQ,EANRvB,EAAAA,EAAAA,IAMQwB,EAAAA,EAAAA,CAJJC,MAAM,UACLC,QAAOC,EAAAA,Y,mBACX,IAED,UAFC,iB,2EAcX,GAEEC,KAAM,aAENzC,OACE,MAAM,CACJ0C,KAAM,CAAC,EACPtB,MAAO,GACPG,UAAW,GACXG,KAAM,GACNiB,OAAO,EACPT,MAAO,CACLC,SAAUS,KAAWA,GAAS,8BAGpC,EAEAC,WAAW,CAAC,EACZC,UACEtC,QAAQC,IAAI,oBACZsC,EAAAA,EAAAA,IAAS,GAAEC,KAAKC,OAAOC,QAAQC,0BAA0BhD,MACrDC,IAEOA,EAAIJ,KAAKoD,MAAMC,SAAS,gBAC3BL,KAAKM,QAAQC,KAAM,SACrB,IAENP,KAAKQ,SACP,EAEAC,QAAQ,CACND,UACET,EAAAA,EAAAA,IAAS,GAAEC,KAAKC,OAAOC,QAAQC,sBAAsBH,KAAKU,OAAOC,OAAOC,MACnEzD,MAAMC,IACL4C,KAAKN,KAAOtC,EAAIJ,IAAG,IAEpB6D,OAAM,SAAU/D,GACfU,QAAQC,IAAI,SACZD,QAAQC,IAAIX,EACd,GAEN,EACAgE,0BACad,KAAKe,MAAMC,KAAKC,YAAYC,QACrCnB,EAAAA,EAAAA,IACK,GAAEC,KAAKC,OAAOC,QAAQC,6BAA6BH,KAAKU,OAAOC,OAAOC,KACvE,CAACxC,MAAO4B,KAAKN,KAAKtB,MAAOG,UAAWyB,KAAKN,KAAKnB,UAAWG,KAAMsB,KAAKN,KAAKhB,KAAMiB,MAAOK,KAAKN,KAAKC,QAClGkB,OAAM,SAAU/D,GAChBU,QAAQC,IAAI,SACZD,QAAQC,IAAIX,EACd,UACMkD,KAAKM,QAAQC,KAAM,UAE7B,I,QC1HJ,MAAMY,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://kportal/./src/api/api.js","webpack://kportal/./src/components/NewsUpdate.vue","webpack://kportal/./src/components/NewsUpdate.vue?669a"],"sourcesContent":["import axios from \"axios\"\r\nimport router from './../router'\r\nimport store from './../store'\r\n\r\n        \r\nconst api = axios.create();\r\n//start request\r\napi.interceptors.request.use(config =>{\r\n  if(localStorage.getItem('access_token')){\r\n    config.headers.authorization = `JWT ${localStorage.getItem('access_token')}`    \r\n  }\r\n  return config\r\n}, error =>{\r\n})\r\n//end request\r\napi.interceptors.response.use(config =>{\r\n  if(localStorage.getItem('access_token')){\r\n    config.headers.authorization = `JWT ${localStorage.getItem('access_token')}`    \r\n  }\r\n  return config\r\n}, error =>{\r\n    if ( error.response.data.code === \"token_not_valid\"){\r\n        return axios.post(`${store.getters.getServerUrl}/auth/jwt/refresh`, {        \r\n            \"refresh\": localStorage.getItem('refresh_token')            \r\n        }).then(res =>{\r\n            //refresh token response\r\n            localStorage.setItem('access_token', res.data.access)\r\n\r\n            error.config.authorization = `JWT ${localStorage.getItem('access_token')}`\r\n            // REPEAT!\r\n            return api.request(error.config)\r\n        }).error(err => {\r\n            console.log('Logout - токен истёк.')            \r\n            store.commit('logout') \r\n        })\r\n    }\r\n//   if(error.response.status === 401){            \r\n//     router.push('/login')\r\n//   }\r\n})\r\n\r\nexport default api","<template>\r\n  <div>\r\n\r\n\r\n    <v-card class=\"my-4 pa-4\">\r\n      <v-card-header>\r\n        <div>\r\n          <span style=\"font-weight: bold\">Tittle:</span>\r\n          <p style=\"white-space: pre-line;\">{{post.title}}</p>\r\n        </div>\r\n      </v-card-header>\r\n      <v-card-header>\r\n        <div>\r\n          <span style=\"font-weight: bold\">Short text:</span>\r\n          <p style=\"white-space: pre-line;\">{{post.shorttext}}</p>\r\n        </div>\r\n      </v-card-header>\r\n      <v-card-header>\r\n        <div>\r\n          <span style=\"font-weight: bold\">Text:</span>\r\n          <p style=\"white-space: pre-line;\">{{post.text}}</p>\r\n        </div>\r\n      </v-card-header>\r\n    </v-card>\r\n\r\n    <v-container>\r\n      <v-form ref=\"form\">\r\n        <v-textarea\r\n            v-model=\"post.title\"\r\n            label=\"Tittle\"\r\n            type=\"text\"\r\n            variant=\"outlined\"\r\n            :rules = \"[rules.required]\"\r\n        >\r\n        </v-textarea>\r\n\r\n        <v-textarea\r\n            v-model=\"post.shorttext\"\r\n            label=\"Short text\"\r\n            type=\"text\"\r\n            variant=\"outlined\"\r\n            :rules = \"[rules.required]\"\r\n        >\r\n        </v-textarea>\r\n\r\n        <v-textarea\r\n            v-model=\"post.text\"\r\n            label=\"Text\"\r\n            type=\"text\"\r\n            variant=\"outlined\"\r\n            :rules = \"[rules.required]\"\r\n        >\r\n        </v-textarea>\r\n\r\n        <v-container\r\n            align=\"center\">\r\n          <v-btn\r\n\r\n              color=\"primary\"\r\n              @click=\"updateNews\"\r\n          >\r\n            Изменить\r\n          </v-btn>\r\n        </v-container>\r\n\r\n      </v-form>\r\n    </v-container>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport API from '../api/api'\r\n\r\nexport default {\r\n\r\n  name: \"NewsUpdate\",\r\n\r\n  data(){\r\n    return{\r\n      post: {},\r\n      title: '',\r\n      shorttext: '',\r\n      text: '',\r\n      short: true,\r\n      rules: {\r\n        required: value => !!value || 'Поле не может быть пустым.'\r\n      },\r\n    }\r\n  },\r\n\r\n  components:{},\r\n  created(){\r\n    console.log('update news page')\r\n    API.get(`${this.$store.getters.getServerUrl}/get_roles`).then(\r\n        res => {\r\n          //Нужно ли добавлять сюда админа или можно будет через админ панель назначить себе группу?\r\n          if (!res.data.roles.includes('news_editor')){\r\n            this.$router.push(`/news/`)\r\n          }\r\n        })\r\n    this.getNews()\r\n  },\r\n\r\n  methods:{\r\n    getNews(){\r\n      API.get(`${this.$store.getters.getServerUrl}/posts/${this.$route.params.id}`)\r\n          .then( res => {\r\n            this.post = res.data\r\n          })\r\n          .catch(function (error) {\r\n            console.log('error')\r\n            console.log(error)\r\n          })\r\n\r\n    },\r\n    async updateNews() {\r\n      if ((await this.$refs.form.validate()).valid) {\r\n        API.put(\r\n            `${this.$store.getters.getServerUrl}/posts/update/${this.$route.params.id}`,\r\n            {title: this.post.title, shorttext: this.post.shorttext, text: this.post.text, short: this.post.short}\r\n        ).catch(function (error) {\r\n          console.log('error')\r\n          console.log(error)\r\n        })\r\n        await this.$router.push(`/news/`)\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>","import { render } from \"./NewsUpdate.vue?vue&type=template&id=21701496\"\nimport script from \"./NewsUpdate.vue?vue&type=script&lang=js\"\nexport * from \"./NewsUpdate.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\motyh\\\\WebstormProjects\\\\frontend\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["api","axios","interceptors","request","use","config","localStorage","getItem","headers","authorization","error","response","data","code","store","then","res","setItem","access","err","console","log","_createElementVNode","style","_createElementBlock","_createVNode","_component_v_card","class","_component_v_card_header","_hoisted_1","_hoisted_2","$data","title","_hoisted_3","_hoisted_4","shorttext","_hoisted_5","_hoisted_6","text","_component_v_container","_component_v_form","ref","_component_v_textarea","label","type","variant","rules","required","align","_component_v_btn","color","onClick","$options","name","post","short","value","components","created","API","this","$store","getters","getServerUrl","roles","includes","$router","push","getNews","methods","$route","params","id","catch","async","$refs","form","validate","valid","__exports__","render"],"sourceRoot":""}