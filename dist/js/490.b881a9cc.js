"use strict";(self["webpackChunkkportal"]=self["webpackChunkkportal"]||[]).push([[490],{8898:function(e,t,o){var s=o(6265),l=o.n(s),r=(o(9058),o(4239));const a=l().create();a.interceptors.request.use((e=>(localStorage.getItem("access_token")&&(e.headers.authorization=`JWT ${localStorage.getItem("access_token")}`),e)),(e=>{})),a.interceptors.response.use((e=>(localStorage.getItem("access_token")&&(e.headers.authorization=`JWT ${localStorage.getItem("access_token")}`),e)),(e=>{if("token_not_valid"===e.response.data.code)return l().post(`${r.Z.getters.getServerUrl}/auth/jwt/refresh`,{refresh:localStorage.getItem("refresh_token")}).then((t=>(localStorage.setItem("access_token",t.data.access),e.config.authorization=`JWT ${localStorage.getItem("access_token")}`,a.request(e.config)))).error((e=>{console.log("Logout - токен истёк."),r.Z.commit("logout")}))})),t["Z"]=a},5490:function(e,t,o){o.r(t),o.d(t,{default:function(){return k}});var s=o(3396),l=o(7139),r=o(5101),a=o(1489),n=o(6422),u=o(3369),i=o(4842);const c=(0,s._)("span",{style:{"font-weight":"bold"}},"Tittle:",-1),d={style:{"white-space":"pre-line"}},p=(0,s._)("span",{style:{"font-weight":"bold"}},"Short text:",-1),h={style:{"white-space":"pre-line"}},g=(0,s._)("span",{style:{"font-weight":"bold"}},"Text:",-1),m={style:{"white-space":"pre-line"}};function w(e,t,o,w,f,_){const v=(0,s.up)("v-card-header");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(a._,{class:"my-4 pa-4"},{default:(0,s.w5)((()=>[(0,s.Wm)(v,null,{default:(0,s.w5)((()=>[(0,s._)("div",null,[c,(0,s._)("p",d,(0,l.zw)(f.post.title),1)])])),_:1}),(0,s.Wm)(v,null,{default:(0,s.w5)((()=>[(0,s._)("div",null,[p,(0,s._)("p",h,(0,l.zw)(f.post.shorttext),1)])])),_:1}),(0,s.Wm)(v,null,{default:(0,s.w5)((()=>[(0,s._)("div",null,[g,(0,s._)("p",m,(0,l.zw)(f.post.text),1)])])),_:1})])),_:1}),(0,s.Wm)(u.K,null,{default:(0,s.w5)((()=>[(0,s.Wm)(n.O,{ref:"form"},{default:(0,s.w5)((()=>[(0,s.Wm)(i.z,{modelValue:f.post.title,"onUpdate:modelValue":t[0]||(t[0]=e=>f.post.title=e),label:"Tittle",type:"text",variant:"outlined",rules:[f.rules.required]},null,8,["modelValue","rules"]),(0,s.Wm)(i.z,{modelValue:f.post.shorttext,"onUpdate:modelValue":t[1]||(t[1]=e=>f.post.shorttext=e),label:"Short text",type:"text",variant:"outlined",rules:[f.rules.required]},null,8,["modelValue","rules"]),(0,s.Wm)(i.z,{modelValue:f.post.text,"onUpdate:modelValue":t[2]||(t[2]=e=>f.post.text=e),label:"Text",type:"text",variant:"outlined",rules:[f.rules.required]},null,8,["modelValue","rules"]),(0,s.Wm)(u.K,{align:"center"},{default:(0,s.w5)((()=>[(0,s.Wm)(r.T,{color:"primary",onClick:_.updateNews},{default:(0,s.w5)((()=>[(0,s.Uk)(" Изменить ")])),_:1},8,["onClick"])])),_:1})])),_:1},512)])),_:1})])}o(7658);var f=o(8898),_={name:"NewsUpdate",data(){return{post:{},title:"",shorttext:"",text:"",short:!0,rules:{required:e=>!!e||"Поле не может быть пустым."}}},components:{},created(){console.log("update news page"),f.Z.get(`${this.$store.getters.getServerUrl}/get_roles`).then((e=>{e.data.roles.includes("news_editor")||this.$router.push("/news/")})),this.getNews()},methods:{getNews(){f.Z.get(`${this.$store.getters.getServerUrl}/posts/${this.$route.params.id}`).then((e=>{this.post=e.data})).catch((function(e){console.log("error"),console.log(e)}))},async updateNews(){(await this.$refs.form.validate()).valid&&(f.Z.put(`${this.$store.getters.getServerUrl}/posts/update/${this.$route.params.id}`,{title:this.post.title,shorttext:this.post.shorttext,text:this.post.text,short:this.post.short}).catch((function(e){console.log("error"),console.log(e)})),await this.$router.push("/news/"))}}},v=o(89);const x=(0,v.Z)(_,[["render",w]]);var k=x}}]);
//# sourceMappingURL=490.b881a9cc.js.map