{"version":3,"file":"js/598.a5bf7ba6.js","mappings":"wJAKA,MAAMA,EAAMC,IAAAA,SAEZD,EAAIE,aAAaC,QAAQC,KAAIC,IACxBC,aAAaC,QAAQ,kBACtBF,EAAOG,QAAQC,cAAiB,OAAMH,aAAaC,QAAQ,mBAEtDF,KACNK,QAGHV,EAAIE,aAAaS,SAASP,KAAIC,IACzBC,aAAaC,QAAQ,kBACtBF,EAAOG,QAAQC,cAAiB,OAAMH,aAAaC,QAAQ,mBAEtDF,KACNK,IACC,GAAkC,oBAA7BA,EAAMC,SAASC,KAAKC,KACrB,OAAOZ,IAAAA,KAAY,GAAEa,EAAAA,EAAAA,QAAAA,gCAA+C,CAChE,QAAWR,aAAaC,QAAQ,mBACjCQ,MAAKC,IAEJV,aAAaW,QAAQ,eAAgBD,EAAIJ,KAAKM,QAE9CR,EAAML,OAAOI,cAAiB,OAAMH,aAAaC,QAAQ,kBAElDP,EAAIG,QAAQO,EAAML,WAC1BK,OAAMS,IACLC,QAAQC,IAAI,yBACZP,EAAAA,EAAAA,OAAa,SAAS,GAE9B,IAMJ,Q,+JCnCqBQ,MAAA,4B,aAIJA,MAAA,4B,aAUAA,MAAA,4B,4EAnBfC,EAAAA,EAAAA,IAqCM,2BAlCEA,EAAAA,EAAAA,IAyBSC,EAAAA,GAAAA,MAAAA,EAAAA,EAAAA,IAzBgCC,EAAAA,OAARC,K,WAAjCC,EAAAA,EAAAA,IAyBSC,EAAAA,EAAAA,CAzBDC,MAAM,YAAmCC,IAAKJ,EAAKK,O,mBACzD,IAEgB,EAFhBC,EAAAA,EAAAA,IAEgBC,EAAAA,KAAAA,C,kBADd,IAA6D,EAA7DC,EAAAA,EAAAA,GAA6D,YAAzDA,EAAAA,EAAAA,GAAoD,IAApDC,GAAoD,QAAhBT,EAAKK,OAAK,Q,WAGzCL,EAAKU,QAAK,WAArBb,EAAAA,EAAAA,IAQM,UAPJW,EAAAA,EAAAA,GAAwD,IAAxDG,GAAwD,QAApBX,EAAKY,WAAS,IAClDN,EAAAA,EAAAA,IAAuBO,EAAAA,IACvBP,EAAAA,EAAAA,IAIiBQ,EAAAA,EAAAA,KAAAA,C,kBAHf,IAAwD,EAAxDR,EAAAA,EAAAA,IAAwDS,EAAAA,EAAAA,CAAhDC,QAAK,GAAEhB,EAAKU,OAAQ,G,mBAAO,IAAa,UAAb,oB,uBACtBX,EAAAA,aAAU,WAAvBE,EAAAA,EAAAA,IAAoGc,EAAAA,EAAAA,C,MAA1EC,QAAK,QAAOC,QAAQC,KAAK,gBAAgBlB,EAAKmB,O,mBAAO,IAAa,UAAb,oB,wCAClEpB,EAAAA,aAAU,WAAvBE,EAAAA,EAAAA,IAAkEc,EAAAA,EAAAA,C,MAAxCC,QAAK,GAAEI,EAAAA,QAAQpB,EAAKmB,K,mBAAK,IAAO,UAAP,c,sEAIvDtB,EAAAA,EAAAA,IAQM,UAPJW,EAAAA,EAAAA,GAAmD,IAAnDa,GAAmD,QAAfrB,EAAKsB,MAAI,IAC7ChB,EAAAA,EAAAA,IAAuBO,EAAAA,IACvBP,EAAAA,EAAAA,IAIiBQ,EAAAA,EAAAA,KAAAA,C,kBAHf,IAAgD,EAAhDR,EAAAA,EAAAA,IAAgDS,EAAAA,EAAAA,CAAxCC,QAAK,GAAEhB,EAAKU,OAAQ,G,mBAAM,IAAM,UAAN,a,uBACrBX,EAAAA,aAAU,WAAvBE,EAAAA,EAAAA,IAAoGc,EAAAA,EAAAA,C,MAA1EC,QAAK,QAAOC,QAAQC,KAAK,gBAAgBlB,EAAKmB,O,mBAAO,IAAa,UAAb,oB,wCAClEpB,EAAAA,aAAU,WAAvBE,EAAAA,EAAAA,IAAkEc,EAAAA,EAAAA,C,MAAxCC,QAAK,GAAEI,EAAAA,QAAQpB,EAAKmB,K,mBAAK,IAAO,UAAP,c,gFAM5CpB,EAAAA,aAAU,WAA7BE,EAAAA,EAAAA,IAKcsB,EAAAA,EAAAA,C,MAJVC,MAAM,U,mBACR,IAEQ,EAFRlB,EAAAA,EAAAA,IAEQS,EAAAA,EAAAA,CAFAC,QAAK,oBAAOC,QAAQC,KAAK,mBAAmBO,MAAM,W,mBAAU,IAEpE,UAFoE,yB,gDAY1E,GACEC,KAAM,OAENxC,OACE,MAAM,CACJyC,MAAO,GACPC,YAAY,EAEhB,EACAC,WAAW,CAAC,EACZC,UACIpC,QAAQC,IAAI,aACZoC,EAAAA,EAAAA,IAAS,GAAEC,KAAKC,OAAOC,QAAQC,0BAA0B9C,MACrDC,IAEE0C,KAAKJ,WAAatC,EAAIJ,KAAKkD,MAAMC,SAAS,cAAc,IAG9DL,KAAKM,SACT,EACAC,QAAQ,CACJD,UAEEP,EAAAA,EAAAA,IAAS,GAAEC,KAAKC,OAAOC,QAAQC,0BAC9B9C,MAAMC,IACHI,QAAQC,IAAI,kBACZD,QAAQC,IAAIL,EAAIJ,MAChB8C,KAAKL,MAAQrC,EAAIJ,IAAG,IAEvBsD,OAAM,SAAUxD,GACbU,QAAQC,IAAI,SACZD,QAAQC,IAAIX,EAChB,GACF,EACFyD,QAAQtB,GAEJY,EAAAA,EAAAA,UAAY,GAAEC,KAAKC,OAAOC,QAAQC,6BAA6BhB,KAC1DqB,OAAM,SAAUxD,GACnBU,QAAQC,IAAI,SACRD,QAAQC,IAAIX,EACpB,IACA,IAAK,IAAI0D,EAAI,EAAGA,EAAIV,KAAKL,MAAMgB,OAASD,GAAK,EACvCV,KAAKL,MAAMe,GAAGvB,IAAMA,GACtBa,KAAKL,MAAMiB,OAAOF,EAAG,EAG3B,I,QCtFJ,MAAMG,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://kportal/./src/api/api.js","webpack://kportal/./src/components/News.vue","webpack://kportal/./src/components/News.vue?80bf"],"sourcesContent":["import axios from \"axios\"\r\nimport router from './../router'\r\nimport store from './../store'\r\n\r\n        \r\nconst api = axios.create();\r\n//start request\r\napi.interceptors.request.use(config =>{\r\n  if(localStorage.getItem('access_token')){\r\n    config.headers.authorization = `JWT ${localStorage.getItem('access_token')}`    \r\n  }\r\n  return config\r\n}, error =>{\r\n})\r\n//end request\r\napi.interceptors.response.use(config =>{\r\n  if(localStorage.getItem('access_token')){\r\n    config.headers.authorization = `JWT ${localStorage.getItem('access_token')}`    \r\n  }\r\n  return config\r\n}, error =>{\r\n    if ( error.response.data.code === \"token_not_valid\"){\r\n        return axios.post(`${store.getters.getServerUrl}/auth/jwt/refresh`, {        \r\n            \"refresh\": localStorage.getItem('refresh_token')            \r\n        }).then(res =>{\r\n            //refresh token response\r\n            localStorage.setItem('access_token', res.data.access)\r\n\r\n            error.config.authorization = `JWT ${localStorage.getItem('access_token')}`\r\n            // REPEAT!\r\n            return api.request(error.config)\r\n        }).error(err => {\r\n            console.log('Logout - токен истёк.')            \r\n            store.commit('logout') \r\n        })\r\n    }\r\n//   if(error.response.status === 401){            \r\n//     router.push('/login')\r\n//   }\r\n})\r\n\r\nexport default api","<template>\r\n  <div>\r\n    \r\n   \r\n          <v-card class=\"my-4 pa-4\" v-for=\"post in posts\" :key=\"post.title\">\r\n            <v-card-header>\r\n              <h1><p style=\"white-space: pre-line;\">{{post.title}}</p></h1>\r\n            </v-card-header>\r\n            \r\n            <div v-if=\"post.short\">\r\n              <p style=\"white-space: pre-line;\">{{post.shorttext}}</p>\r\n              <v-divider></v-divider>\r\n              <v-card-actions>\r\n                <v-btn @click=\"post.short = false\">Читать дальше</v-btn>\r\n                <v-btn v-if=\"editorNews\" @click=\"this.$router.push(`/news/update/${post.id}`)\">Редактировать</v-btn>\r\n                <v-btn v-if=\"editorNews\" @click=\"DelNews(post.id)\">Удалить</v-btn>\r\n              </v-card-actions>\r\n            </div>\r\n\r\n            <div v-else>\r\n              <p style=\"white-space: pre-line;\">{{post.text}}</p>\r\n              <v-divider></v-divider>\r\n              <v-card-actions>\r\n                <v-btn @click=\"post.short = true\">Скрыть</v-btn>\r\n                <v-btn v-if=\"editorNews\" @click=\"this.$router.push(`/news/update/${post.id}`)\">Редактировать</v-btn>\r\n                <v-btn v-if=\"editorNews\" @click=\"DelNews(post.id)\">Удалить</v-btn>\r\n              </v-card-actions>\r\n            </div>\r\n          \r\n          </v-card>\r\n\r\n    <v-container v-if=\"editorNews\"\r\n        align=\"center\">\r\n      <v-btn @click=\"this.$router.push(`/news/addNews/`)\" color=\"primary\">\r\n        Добавить новость\r\n      </v-btn>\r\n    </v-container>\r\n      \r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport API from '../api/api'\r\n\r\nexport default {\r\n  name: 'News',\r\n  //props:,\r\n  data(){\r\n    return{\r\n      posts: [],\r\n      editorNews: false,\r\n    }\r\n  },\r\n  components:{},\r\n  created(){ \r\n      console.log('news page')\r\n      API.get(`${this.$store.getters.getServerUrl}/get_roles`).then(\r\n          res => {\r\n            //Нужно ли добавлять сюда админа или можно будет через админ панель назначить себе группу?\r\n            this.editorNews = res.data.roles.includes('news_editor')\r\n          }\r\n      )\r\n      this.getNews()\r\n  },\r\n  methods:{    \r\n      getNews(){\r\n\r\n        API.get(`${this.$store.getters.getServerUrl}/posts/all`)\r\n        .then( res => {\r\n            console.log('response staff')\r\n            console.log(res.data)\r\n            this.posts = res.data\r\n        })\r\n        .catch(function (error) {\r\n            console.log('error')\r\n            console.log(error)\r\n        })\r\n      },\r\n    DelNews(id){\r\n\r\n        API.delete(`${this.$store.getters.getServerUrl}/posts/delete/${id}`)\r\n            .catch(function (error) {\r\n          console.log('error')\r\n              console.log(error)\r\n      })\r\n      for (let i = 0; i < this.posts.length ; i += 1) {\r\n        if (this.posts[i].id == id) {\r\n          this.posts.splice(i, 1)\r\n        }\r\n      }\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n\r\n</style>\r\n","import { render } from \"./News.vue?vue&type=template&id=4871339f\"\nimport script from \"./News.vue?vue&type=script&lang=js\"\nexport * from \"./News.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\motyh\\\\WebstormProjects\\\\frontend\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["api","axios","interceptors","request","use","config","localStorage","getItem","headers","authorization","error","response","data","code","store","then","res","setItem","access","err","console","log","style","_createElementBlock","_Fragment","$data","post","_createBlock","_component_v_card","class","key","title","_createVNode","_component_v_card_header","_createElementVNode","_hoisted_1","short","_hoisted_3","shorttext","_component_v_divider","_component_v_card_actions","_component_v_btn","onClick","$router","push","id","$options","_hoisted_5","text","_component_v_container","align","color","name","posts","editorNews","components","created","API","this","$store","getters","getServerUrl","roles","includes","getNews","methods","catch","DelNews","i","length","splice","__exports__","render"],"sourceRoot":""}