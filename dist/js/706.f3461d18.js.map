{"version":3,"file":"js/706.f3461d18.js","mappings":"wJAKA,MAAMA,EAAMC,IAAAA,SAEZD,EAAIE,aAAaC,QAAQC,KAAIC,IACxBC,aAAaC,QAAQ,kBACtBF,EAAOG,QAAQC,cAAiB,OAAMH,aAAaC,QAAQ,mBAEtDF,KACNK,QAGHV,EAAIE,aAAaS,SAASP,KAAIC,IACzBC,aAAaC,QAAQ,kBACtBF,EAAOG,QAAQC,cAAiB,OAAMH,aAAaC,QAAQ,mBAEtDF,KACNK,IACC,GAAkC,oBAA7BA,EAAMC,SAASC,KAAKC,KACrB,OAAOZ,IAAAA,KAAY,GAAEa,EAAAA,EAAAA,QAAAA,gCAA+C,CAChE,QAAWR,aAAaC,QAAQ,mBACjCQ,MAAKC,IAEJV,aAAaW,QAAQ,eAAgBD,EAAIJ,KAAKM,QAE9CR,EAAML,OAAOI,cAAiB,OAAMH,aAAaC,QAAQ,kBAElDP,EAAIG,QAAQO,EAAML,WAC1BK,OAAMS,IACLC,QAAQC,IAAI,yBACZP,EAAAA,EAAAA,OAAa,gBAQzB,U,mGCvCQQ,EAAAA,EAAAA,GAAuB,UAAnB,kBAAc,G,0CADtBC,EAAAA,EAAAA,IAKM,YAJFC,GAIE,QAJqB,KAEvBC,EAAAA,EAAAA,IAAEC,EAAAA,aAAanB,QAAO,sB,cAQ9B,GACEoB,KAAM,SAENf,OACE,MAAM,CACJgB,YAAa,GACbC,MAAO,GACPvB,aAAAA,eAGJwB,WAAW,GACXC,UACIX,QAAQC,IAAI,eACZW,KAAKC,YACLD,KAAKE,WACLF,KAAKG,eAETC,QAAQ,CACJH,YACEI,EAAAA,EAAAA,IAAS,GAAEL,KAAKM,OAAOC,QAAQC,qBAC9BzB,MAAMC,IACHI,QAAQC,IAAI,mBACZD,QAAQC,IAAIL,GACZI,QAAQC,IAAIf,aAAaC,QAAQ,iBACjCyB,KAAKJ,YAAcZ,EAAIJ,KAAK6B,OAG/BC,OAAM,SAAUhC,GACbU,QAAQC,IAAI,SACZD,QAAQC,IAAIX,OAGjBwB,WACCG,EAAAA,EAAAA,IAAS,GAAEL,KAAKM,OAAOC,QAAQC,0BAC9BzB,MAAMC,IACHI,QAAQC,IAAI,kBACZD,QAAQC,IAAIL,EAAIJ,MAChBoB,KAAKH,MAAQb,EAAIJ,KAAKiB,SAGzBa,OAAM,SAAUhC,GACbU,QAAQC,IAAI,SACZD,QAAQC,IAAIX,OAGjByB,cACCE,EAAAA,EAAAA,IAAS,GAAEL,KAAKM,OAAOC,QAAQC,+BAC9BzB,MAAMC,IACHI,QAAQC,IAAI,qBACZD,QAAQC,IAAIL,EAAIJ,MAChBoB,KAAKW,SAAW3B,EAAIJ,QAGvB8B,OAAM,SAAUhC,GACbU,QAAQC,IAAI,SACZD,QAAQC,IAAIX,S,QC9DxB,MAAMkC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE","sources":["webpack://kportal/./src/api/api.js","webpack://kportal/./src/components/Secure.vue","webpack://kportal/./src/components/Secure.vue?50b1"],"sourcesContent":["import axios from \"axios\"\r\nimport router from './../router'\r\nimport store from './../store'\r\n\r\n        \r\nconst api = axios.create();\r\n//start request\r\napi.interceptors.request.use(config =>{\r\n  if(localStorage.getItem('access_token')){\r\n    config.headers.authorization = `JWT ${localStorage.getItem('access_token')}`    \r\n  }\r\n  return config\r\n}, error =>{\r\n})\r\n//end request\r\napi.interceptors.response.use(config =>{\r\n  if(localStorage.getItem('access_token')){\r\n    config.headers.authorization = `JWT ${localStorage.getItem('access_token')}`    \r\n  }\r\n  return config\r\n}, error =>{\r\n    if ( error.response.data.code === \"token_not_valid\"){\r\n        return axios.post(`${store.getters.getServerUrl}/auth/jwt/refresh`, {        \r\n            \"refresh\": localStorage.getItem('refresh_token')            \r\n        }).then(res =>{\r\n            //refresh token response\r\n            localStorage.setItem('access_token', res.data.access)\r\n\r\n            error.config.authorization = `JWT ${localStorage.getItem('access_token')}`\r\n            // REPEAT!\r\n            return api.request(error.config)\r\n        }).error(err => {\r\n            console.log('Logout - токен истёк.')            \r\n            store.commit('logout') \r\n        })\r\n    }\r\n//   if(error.response.status === 401){            \r\n//     router.push('/login')\r\n//   }\r\n})\r\n\r\nexport default api","<template>\r\n    <div>\r\n        <h2>Личный кабинет</h2>\r\n\r\n        {{localStorage.getItem('tmp_username')}}\r\n\r\n    </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport API from '../api/api'\r\nexport default {\r\n  name: 'Secure',\r\n  //props:,\r\n  data(){\r\n    return{\r\n      secure_data: \"\",\r\n      roles: [],\r\n      localStorage\r\n    }\r\n  },\r\n  components:{},\r\n  created(){ \r\n      console.log('secure page')\r\n      this.getSecure()\r\n      this.getRoles()\r\n      this.getServices()\r\n  },\r\n  methods:{    \r\n      getSecure(){\r\n        API.get(`${this.$store.getters.getServerUrl}/test`)\r\n        .then( res => {\r\n            console.log('response secure')\r\n            console.log(res)\r\n            console.log(localStorage.getItem('tmp_username'))\r\n            this.secure_data = res.data.key\r\n            //localStorage.setItem('access_token', res.data.access)\r\n        })\r\n        .catch(function (error) {\r\n            console.log('error')\r\n            console.log(error)\r\n        })\r\n      },\r\n       getRoles(){\r\n        API.get(`${this.$store.getters.getServerUrl}/get_roles`)\r\n        .then( res => {\r\n            console.log('response roles')\r\n            console.log(res.data)\r\n            this.roles = res.data.roles\r\n            //localStorage.setItem('access_token', res.data.access)\r\n        })\r\n        .catch(function (error) {\r\n            console.log('error')\r\n            console.log(error)\r\n        })\r\n      },\r\n       getServices(){\r\n        API.get(`${this.$store.getters.getServerUrl}/service/for_me`)\r\n        .then( res => {\r\n            console.log('response services')\r\n            console.log(res.data)\r\n            this.services = res.data\r\n            //localStorage.setItem('access_token', res.data.access)\r\n        })\r\n        .catch(function (error) {\r\n            console.log('error')\r\n            console.log(error)\r\n        })\r\n      },\r\n  },\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n\r\n</style>\r\n","import { render } from \"./Secure.vue?vue&type=template&id=31bba06e\"\nimport script from \"./Secure.vue?vue&type=script&lang=js\"\nexport * from \"./Secure.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\motyh\\\\WebstormProjects\\\\frontend\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["api","axios","interceptors","request","use","config","localStorage","getItem","headers","authorization","error","response","data","code","store","then","res","setItem","access","err","console","log","_createElementVNode","_createElementBlock","_hoisted_1","_toDisplayString","$data","name","secure_data","roles","components","created","this","getSecure","getRoles","getServices","methods","API","$store","getters","getServerUrl","key","catch","services","__exports__","render"],"sourceRoot":""}