"use strict";(self["webpackChunkkportal"]=self["webpackChunkkportal"]||[]).push([[598],{8898:function(e,t,o){var s=o(6265),r=o.n(s),l=(o(6802),o(4239));const n=r().create();n.interceptors.request.use((e=>(localStorage.getItem("access_token")&&(e.headers.authorization=`JWT ${localStorage.getItem("access_token")}`),e)),(e=>{})),n.interceptors.response.use((e=>(localStorage.getItem("access_token")&&(e.headers.authorization=`JWT ${localStorage.getItem("access_token")}`),e)),(e=>{if("token_not_valid"===e.response.data.code)return r().post(`${l.Z.getters.getServerUrl}/auth/jwt/refresh`,{refresh:localStorage.getItem("refresh_token")}).then((t=>(localStorage.setItem("access_token",t.data.access),e.config.authorization=`JWT ${localStorage.getItem("access_token")}`,n.request(e.config)))).error((e=>{console.log("Logout - токен истёк."),l.Z.commit("logout")}))})),t["Z"]=n},4598:function(e,t,o){o.r(t),o.d(t,{default:function(){return T}});var s=o(3396),r=o(7139),l=o(2882),n=o(1489),a=o(7783),i=o(1334),c=o(4075),u=o(3369);const g={style:{"white-space":"pre-line"}},d={key:0},w={style:{"white-space":"pre-line"}},k=(0,s.Uk)("Читать дальше"),h=(0,s.Uk)("Редактировать"),p=(0,s.Uk)("Удалить"),f={key:1},_={style:{"white-space":"pre-line"}},m=(0,s.Uk)("Скрыть"),$=(0,s.Uk)("Редактировать"),C=(0,s.Uk)("Удалить"),N=(0,s.Uk)(" Добавить новость ");function y(e,t,o,y,v,S){return(0,s.wg)(),(0,s.iD)("div",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(v.posts,(e=>((0,s.wg)(),(0,s.j4)(n._,{class:"my-4 pa-4",key:e.title},{default:(0,s.w5)((()=>[(0,s.Wm)(a.k,null,{default:(0,s.w5)((()=>[(0,s._)("h1",null,[(0,s._)("p",g,(0,r.zw)(e.title),1)])])),_:2},1024),e.short?((0,s.wg)(),(0,s.iD)("div",d,[(0,s._)("p",w,(0,r.zw)(e.shorttext),1),(0,s.Wm)(c.J),(0,s.Wm)(i.h,null,{default:(0,s.w5)((()=>[(0,s.Wm)(l.T,{onClick:t=>e.short=!1},{default:(0,s.w5)((()=>[k])),_:2},1032,["onClick"]),v.editorNews?((0,s.wg)(),(0,s.j4)(l.T,{key:0,onClick:t=>this.$router.push(`/news/update/${e.id}`)},{default:(0,s.w5)((()=>[h])),_:2},1032,["onClick"])):(0,s.kq)("",!0),v.editorNews?((0,s.wg)(),(0,s.j4)(l.T,{key:1,onClick:t=>S.DelNews(e.id)},{default:(0,s.w5)((()=>[p])),_:2},1032,["onClick"])):(0,s.kq)("",!0)])),_:2},1024)])):((0,s.wg)(),(0,s.iD)("div",f,[(0,s._)("p",_,(0,r.zw)(e.text),1),(0,s.Wm)(c.J),(0,s.Wm)(i.h,null,{default:(0,s.w5)((()=>[(0,s.Wm)(l.T,{onClick:t=>e.short=!0},{default:(0,s.w5)((()=>[m])),_:2},1032,["onClick"]),v.editorNews?((0,s.wg)(),(0,s.j4)(l.T,{key:0,onClick:t=>this.$router.push(`/news/update/${e.id}`)},{default:(0,s.w5)((()=>[$])),_:2},1032,["onClick"])):(0,s.kq)("",!0),v.editorNews?((0,s.wg)(),(0,s.j4)(l.T,{key:1,onClick:t=>S.DelNews(e.id)},{default:(0,s.w5)((()=>[C])),_:2},1032,["onClick"])):(0,s.kq)("",!0)])),_:2},1024)]))])),_:2},1024)))),128)),v.editorNews?((0,s.wg)(),(0,s.j4)(u.K,{key:0,align:"center"},{default:(0,s.w5)((()=>[(0,s.Wm)(l.T,{onClick:t[0]||(t[0]=e=>this.$router.push("/news/addNews/")),color:"primary"},{default:(0,s.w5)((()=>[N])),_:1})])),_:1})):(0,s.kq)("",!0)])}var v=o(8898),S={name:"News",data(){return{posts:[],editorNews:!1}},components:{},created(){console.log("news page"),v.Z.get(`${this.$store.getters.getServerUrl}/get_roles`).then((e=>{this.editorNews=e.data.roles.includes("news_editor")})),this.getNews()},methods:{getNews(){v.Z.get(`${this.$store.getters.getServerUrl}/posts/all`).then((e=>{console.log("response staff"),console.log(e.data),this.posts=e.data})).catch((function(e){console.log("error"),console.log(e)}))},DelNews(e){v.Z["delete"](`${this.$store.getters.getServerUrl}/posts/delete/${e}`).catch((function(e){console.log("error"),console.log(e)}));for(let t=0;t<this.posts.length;t+=1)this.posts[t].id==e&&this.posts.splice(t,1)}}},U=o(89);const W=(0,U.Z)(S,[["render",y]]);var T=W}}]);
//# sourceMappingURL=598.f05fd594.js.map